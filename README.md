# AuditKit - Multi-Framework Compliance Scanner & Evidence Collection

**Open-source compliance scanner with auditor-ready evidence collection guides.**

[![GitHub stars](https://img.shields.io/github/stars/guardian-nexus/auditkit)](https://github.com/guardian-nexus/auditkit/stargazers)
[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
![Version](https://img.shields.io/badge/version-v0.4.1-green)
[![Newsletter](https://img.shields.io/badge/Newsletter-Subscribe-orange)](https://auditkit.substack.com)

## What AuditKit Does

AuditKit scans your AWS infrastructure against SOC2 Common Criteria controls and provides:

1. **Clear Pass/Fail Status** - 64 SOC2 controls checked automatically
2. **Exact Fix Commands** - Not just "enable MFA", but the actual AWS CLI command
3. **Evidence Collection Guides** - Step-by-step screenshots auditors actually accept
4. **Priority-Based Fixes** - Critical issues that will fail your audit vs. nice-to-haves

## Quick Start

```bash
# Install
go install github.com/guardian-nexus/auditkit/scanner/cmd/auditkit@latest

# Configure AWS credentials
aws configure

# Run SOC2 scan
auditkit scan -framework soc2

# Generate PDF report with evidence checklist
auditkit scan -framework soc2 -format pdf -output soc2-report.pdf

# Generate fix script
auditkit fix -output remediation.sh
```

## Current Status

| Component | Status | Notes |
|-----------|--------|-------|
| **SOC2** | ‚úÖ Full Support | All 64 Common Criteria controls (CC1-CC9) |
| **AWS** | ‚úÖ Full Support | S3, IAM, EC2, CloudTrail, RDS, Config, GuardDuty, etc. |
| **PCI-DSS** | üß™ Experimental | Limited control mapping only |
| **HIPAA** | üß™ Experimental | Limited control mapping only |
| **Azure** | üöß Coming Soon | Planned for v0.5 |
| **GCP** | üöß Coming Soon | Planned for v0.6 |

## What Makes AuditKit Different

### 1. Evidence Collection That Auditors Accept

```yaml
Control Failed: CC6.2 - Public S3 Bucket
Fix Command: aws s3api put-public-access-block --bucket my-bucket --public-access-block-configuration "BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true"

Evidence Required:
1. Navigate to: https://s3.console.aws.amazon.com/s3/buckets/my-bucket
2. Click "Permissions" tab
3. Screenshot showing all 4 "Block public access" settings = ON
4. Save as: SOC2_CC6.2_S3_Public_Access.png
```

### 2. Prioritized by Audit Impact

```
üî• CRITICAL (2 issues) - Will fail your audit
  ‚îî‚îÄ CC6.6: Root account missing MFA
  ‚îî‚îÄ CC7.1: CloudTrail not enabled

‚ö†Ô∏è HIGH (5 issues) - Auditor will flag these
  ‚îî‚îÄ CC6.7: No password policy configured
  ‚îî‚îÄ CC3.2: GuardDuty not enabled
  ‚îî‚îÄ ...

üìã MEDIUM (8 issues) - Should fix for smooth audit
```

### 3. Real Fix Scripts, Not Documentation

```bash
# Generated by: auditkit fix -output remediation.sh

#!/bin/bash
# Critical Fixes - Run These First

echo "Enabling MFA for root account..."
# Manual step required - see PDF report for screenshots

echo "Enabling CloudTrail..."
aws cloudtrail create-trail --name audit-trail --s3-bucket-name my-audit-bucket
aws cloudtrail start-logging --name audit-trail

echo "Setting password policy..."
aws iam update-account-password-policy \
  --minimum-password-length 14 \
  --require-symbols \
  --require-numbers \
  --require-uppercase-characters \
  --require-lowercase-characters \
  --max-password-age 90
```

## SOC2 Controls Coverage

| Category | Controls | Description |
|----------|----------|-------------|
| **CC1** | 5 controls | Control Environment (governance, ethics, structure) |
| **CC2** | 3 controls | Communication & Information |
| **CC3** | 4 controls | Risk Assessment |
| **CC4** | 2 controls | Monitoring Activities |
| **CC5** | 3 controls | Control Activities |
| **CC6** | 8 controls | Logical & Physical Access Controls |
| **CC7** | 4 controls | System Operations |
| **CC8** | 1 control | Change Management |
| **CC9** | 2 controls | Risk Mitigation |
| **Total** | **64 controls** | Full Common Criteria coverage |

## Requirements

- Go 1.19+
- AWS credentials configured
- AWS services to check: IAM, S3, EC2, CloudTrail, Config, GuardDuty, Security Hub, etc.

## Important Disclaimers

1. **This is a preparation tool** - SOC2 certification requires a CPA audit
2. **AWS-only currently** - Azure and GCP support coming soon
3. **PCI/HIPAA are experimental** - Only basic control mapping implemented
4. **Not a replacement for professional services** - Use alongside qualified auditors

## Command Reference

```bash
# Scanning
auditkit scan                          # Default SOC2 scan
auditkit scan -framework soc2          # Explicit SOC2 scan
auditkit scan -framework pci           # Experimental PCI scan
auditkit scan -verbose                 # Detailed output

# Reporting
auditkit scan -format pdf -output report.pdf    # PDF with evidence checklist
auditkit scan -format json                       # JSON output
auditkit scan -format html -output report.html   # HTML report

# Remediation
auditkit fix                           # Generate fix script
auditkit fix -output fixes.sh          # Save to file

# Progress Tracking
auditkit progress                      # Show improvement over time
auditkit compare                       # Compare last two scans

# Evidence Collection
auditkit evidence                      # Generate evidence tracker
auditkit evidence -output tracker.html  # Save tracker
```

## Installation Options

### From Source
```bash
git clone https://github.com/guardian-nexus/auditkit
cd auditkit/scanner
go build ./cmd/auditkit
./auditkit scan
```

### Using Go Install
```bash
go install github.com/guardian-nexus/auditkit/scanner/cmd/auditkit@latest
```

### Download Binary
See [Releases](https://github.com/guardian-nexus/auditkit/releases) for pre-built binaries.

## Project Structure

```
auditkit/
‚îú‚îÄ‚îÄ scanner/
‚îÇ   ‚îú‚îÄ‚îÄ cmd/auditkit/         # CLI entry point
‚îÇ   ‚îî‚îÄ‚îÄ pkg/
‚îÇ       ‚îú‚îÄ‚îÄ aws/               # AWS provider
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ checks/        # SOC2 control checks
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ soc2_cc1_cc2.go
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ soc2_cc3_cc5.go
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ soc2_cc6_cc9.go
‚îÇ       ‚îú‚îÄ‚îÄ report/            # PDF/HTML generation
‚îÇ       ‚îú‚îÄ‚îÄ remediation/       # Fix script generation
‚îÇ       ‚îî‚îÄ‚îÄ tracker/           # Evidence tracking
‚îî‚îÄ‚îÄ README.md
```

## Roadmap

- [x] v0.4.1 - Full SOC2 controls (Sep 2025)
- [ ] v0.5.0 - Azure support (Oct 2025)
- [ ] v0.6.0 - GCP support (Oct 2025)
- [ ] v0.7.0 - Full PCI-DSS mapping (Nov 2025)
- [ ] v0.8.0 - Full HIPAA mapping (Nov 2025)
- [ ] v1.0.0 - Automated evidence collection (Dec 2025)

## Contributing

We need help with:
1. Azure/GCP provider implementation
2. Complete PCI-DSS control mapping
3. Complete HIPAA control mapping
4. Automated screenshot collection (Selenium?)
5. Terraform compliance checks

See [CONTRIBUTING.md](CONTRIBUTING.md) for details.

## Support

- **Issues**: [GitHub Issues](https://github.com/guardian-nexus/auditkit/issues)
- **Discussions**: [GitHub Discussions](https://github.com/guardian-nexus/auditkit/discussions)
- **Updates**: [Newsletter](https://auditkit.substack.com)

## FAQ

**Q: Why is my compliance score so low?**  
A: You need AWS services configured. Enable GuardDuty, Security Hub, Config, CloudTrail, etc. The scanner checks if these services exist and are properly configured.

**Q: Can this replace a SOC2 audit?**  
A: No. This helps you prepare for an audit. You still need a CPA firm for actual SOC2 certification.

**Q: When will Azure/GCP be supported?**  
A: Azure in v0.5 (October 2025), GCP in v0.6 (October 2025).

**Q: What about ISO 27001, NIST, CIS?**  
A: On the roadmap after core cloud providers are complete.

## License

Apache 2.0 - Use it, modify it, sell it. Just help others pass their audits.

---

*Built by engineers who've been through too many SOC2 audits.*

*If this saves you audit prep time, consider [supporting development](https://www.buymeacoffee.com/auditkit).*
